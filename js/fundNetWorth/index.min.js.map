{"version":3,"sources":["fundNetWorth/index.js"],"names":["ajaxLoadFundNetWorth","deferred","$","Deferred","postdata","companyId","filterXSS","sessionStorage","getItem","val","typeId","keyword","ajax","url","Constants","getFundNetWorthUrl","type","data","done","response","fundNetWorthList","fundTypeHtml","each","index","fundNetWorthItem","fundsHtml","Funds","fundsItem","fmtNetWorthDate","Date","NetWorthDate","format","push","FundId","FundShortName","MoneyTypeName","NetWorth","cxRise","RiseAndDecline","FundType","TypeName","join","removeClass","length","addClass","html","resolve","promise","document","on","event","dLoadCompany","dLoadType","App","StartLoading","loadWarning","loadSelectFundCompany","success","failure","reject","loadSelectFundType","when","then","selectmenu","StopLoading","setItem","this","location","href","pattern","test","ShowAlert"],"mappings":"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","file":"fundNetWorth/index.min.js","sourcesContent":["function ajaxLoadFundNetWorth(){\n\n  var deferred = $.Deferred();\n\n  var postdata = {};\n  postdata.companyId = filterXSS(sessionStorage.getItem(\"fundCompany\")) || $(\"#select-company\").val();\n  if(sessionStorage.getItem(\"fundType\")){\n    postdata.typeId = filterXSS(sessionStorage.getItem(\"fundType\")) || $(\"#select-type\").val();\n  }\n  if(sessionStorage.getItem(\"fundKeyword\")){\n    postdata.keyword = filterXSS(sessionStorage.getItem(\"fundKeyword\")) || $(\"#input-keyword\").val();\n  }\n\n  $.ajax({\n      url: Constants.getFundNetWorthUrl(),\n      type:\"GET\",\n      data:postdata\n  }).done(function(response){\n      var fundNetWorthList = response,\n          fundTypeHtml = [];\n      $.each(fundNetWorthList, function(index,fundNetWorthItem) {\n        var fundsHtml = [];\n        $.each(fundNetWorthItem.Funds,function(index,fundsItem){\n\n          var fmtNetWorthDate = (fundsItem.NetWorthDate) ? new Date(fundsItem.NetWorthDate).format(\"mm/dd\") : \"N/A\";\n          \n          fundsHtml.push(\"<tbody class='fund-item' data-fundid=\" + fundsItem.FundId  +\">\");\n          fundsHtml.push(\"<td class='shortname'>\" + fundsItem.FundShortName  + \"</td>\");\n          fundsHtml.push(\"<td>\" + fundsItem.MoneyTypeName  + \"</td>\");\n          fundsHtml.push(\"<td>\");\n          fundsHtml.push(\"  <div class='net-worth'>\" + fundsItem.NetWorth  + \"</div>\");\n          fundsHtml.push(\"  <div class='net-worth-date'>(\" + fmtNetWorthDate + \")</div>\");\n          fundsHtml.push(\"</td>\");\n          fundsHtml.push(\"<td>\");\n          fundsHtml.push(\"  <span class='\" + $.cxRise(fundsItem.RiseAndDecline) +  \"'>\" + fundsItem.RiseAndDecline + \"</span>\");\n          fundsHtml.push(\"</td>\");\n          fundsHtml.push(\"<td class='indicator'></td>\");\n          fundsHtml.push(\"</tbody>\");\n        });\n        fundTypeHtml.push(\"<div data-role='headline'>\");\n        fundTypeHtml.push(\" <p>\" + fundNetWorthItem.FundType.TypeName + \"</p>\");\n        fundTypeHtml.push(\"</div>\");\n        fundTypeHtml.push(\"<table data-role='table'>\");\n        fundTypeHtml.push(\" <thead>\");\n        fundTypeHtml.push(\"   <th>基金名稱</th><th>幣別</th><th>最新<br>淨值</th><th>漲跌幅</th><th></th>\");\n        fundTypeHtml.push(\" </thead>\");\n        fundTypeHtml.push(  fundsHtml.join(\" \"));        \n        fundTypeHtml.push(\"</table>\");\n      });\n\n      $(\"#result-block\").removeClass();\n      if(fundTypeHtml && fundTypeHtml.length > 0){\n        $(\"#result-block\").addClass('has-data').html(fundTypeHtml.join(\" \"));\n      }else{\n        $(\"#result-block\").addClass('empty-data').html(\"<div class='no-result'>無查詢結果</div>\");\n      }\n\n      deferred.resolve();\n  });\n\n  return deferred.promise();    \n\n}\n\n$(document).on( \"pageinit\", \"#page-fund-nv\", function(event) {\n\n  //使用Derffered Ojbect讓資料載入後，再解除Loading\n  var dLoadCompany = $.Deferred(),\n      dLoadType = $.Deferred();\n\n  App.StartLoading();    \n\n  $(\".numura-warning\").loadWarning();\n\n  $(\"#input-keyword\").val(sessionStorage.getItem(\"fundKeyword\"));\n\n  $(\"#select-company\").loadSelectFundCompany(\n      {\n        \"success\":function(){\n          dLoadCompany.resolve();\n        },\"failure\":function(){\n          dLoadCompany.reject();\n        }\n      }\n  );\n\n  $(\"#select-type\").loadSelectFundType(\n      {\n        \"success\":function(){\n          dLoadType.resolve();\n        },\"failure\":function(){\n          dLoadType.reject();\n        }\n      }    \n  );\n\n  $.when(dLoadCompany,dLoadType)\n    .then(function(){\n      if(sessionStorage.getItem(\"fundCompany\")){\n        $(\"#select-company\")\n          .val(sessionStorage.getItem(\"fundCompany\"))\n          .selectmenu(\"refresh\",true);\n      }\n      if(sessionStorage.getItem(\"fundType\")){\n        $(\"#select-type\")\n          .val(sessionStorage.getItem(\"fundType\"))\n          .selectmenu(\"refresh\",true);\n      }\n      //ajaxLoadFundNetWorth();      \n      $.when(ajaxLoadFundNetWorth()).done(function(){\n        App.StopLoading();\n      });\n    }).done(function(){\n      //App.StopLoading();\n  });\n  \n\n});\n\n$(document).on(\"vclick\",\".fund-item\",function(event){\n    sessionStorage.setItem(\"fundid\",$(this).data(\"fundid\"));\n    location.href = \"../html/singleFundTrend.html\";\n});\n\n$(document).on(\"vclick\",\"#btn-submit\",function(event){\n  var pattern = /^[A-z0-9 \\u4e00-\\u9fa5]+$/;\n  var keyword = $(\"#input-keyword\").val();\n  if(keyword.length > 0 && !pattern.test(keyword)){\n    App.ShowAlert('請勿輸入符號或全形英數',\"\",\"確定\");\n    return false;\n  }\n\n  sessionStorage.setItem(\"fundCompany\",$(\"#select-company\").val());\n  sessionStorage.setItem(\"fundType\",$(\"#select-type\").val());\n  sessionStorage.setItem(\"fundKeyword\",keyword);\n\n  App.StartLoading();\n\n  $.when(ajaxLoadFundNetWorth()).done(function(){\n    App.StopLoading();\n  });\n  \n});"],"sourceRoot":"/source/"}