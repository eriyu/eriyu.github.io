{"version":3,"sources":["fundNetWorth/fundOverviewIndex.js"],"names":["ajaxLoadFundNetWorth","deferred","$","Deferred","postdata","companyId","filterXSS","sessionStorage","getItem","val","typeId","keyword","ajax","url","Constants","getFundNetWorthUrl","type","data","done","response","console","log","fundNetWorthList","fundTypeHtml","each","index","fundNetWorthItem","fundsHtml","Funds","fundsItem","Date","NetWorthDate","format","push","FundId","FundShortName","MoneyTypeName","TypeName","InvestArea","FundType","join","removeClass","length","addClass","html","resolve","promise","document","on","event","dLoadCompany","dLoadType","App","StartLoading","loadWarning","loadSelectFundCompany","success","failure","reject","loadSelectFundType","when","then","selectmenu","StopLoading","setItem","this","location","href","pattern","test","ShowAlert"],"mappings":"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","file":"fundNetWorth/fundOverviewIndex.min.js","sourcesContent":["function ajaxLoadFundNetWorth(){\n\n  var deferred = $.Deferred();\n\n  var postdata = {};\n  postdata.companyId = filterXSS(sessionStorage.getItem(\"fundCompany\")) || $(\"#select-company\").val();\n  if(sessionStorage.getItem(\"fundType\")){\n    postdata.typeId = filterXSS(sessionStorage.getItem(\"fundType\")) || $(\"#select-type\").val();\n  }\n  if(sessionStorage.getItem(\"fundKeyword\")){\n    postdata.keyword = filterXSS(sessionStorage.getItem(\"fundKeyword\")) || $(\"#input-keyword\").val();\n  }\n\n  $.ajax({\n      url: Constants.getFundNetWorthUrl(),\n      type:\"GET\",\n      data:postdata\n  }).done(function(response){\n      console.log(\"response\",response);\n      var fundNetWorthList = response,\n          fundTypeHtml = [];\n      $.each(fundNetWorthList, function(index,fundNetWorthItem) {\n        var fundsHtml = [];\n        $.each(fundNetWorthItem.Funds,function(index,fundsItem){\n\n          var fmtNetWorthDate = (fundsItem.NetWorthDate) ? new Date(fundsItem.NetWorthDate).format(\"mm/dd\") : \"N/A\";\n\n          fundsHtml.push(\"<tbody class='fund-item' data-fundid=\" + fundsItem.FundId  +\">\");\n          fundsHtml.push(\"<td class='shortname'>\" + fundsItem.FundShortName  + \"</td>\");\n          fundsHtml.push(\"<td>\" + fundsItem.MoneyTypeName  + \"</td>\");\n          fundsHtml.push(\"<td>\" + fundsItem.TypeName  + \"</td>\");\n          fundsHtml.push(\"<td>\" + fundsItem.InvestArea  + \"</td>\");\n          fundsHtml.push(\"<td class='indicator'></td>\");\n          fundsHtml.push(\"</tbody>\");\n        });\n        fundTypeHtml.push(\"<div data-role='headline'>\");\n        fundTypeHtml.push(\" <p>\" + fundNetWorthItem.FundType.TypeName + \"</p>\");\n        fundTypeHtml.push(\"</div>\");\n        fundTypeHtml.push(\"<table data-role='table'>\");\n        fundTypeHtml.push(\" <thead>\");\n        fundTypeHtml.push(\"   <th>基金名稱</th><th>幣別</th><th>基金類別</th><th>投資<br>區域</th><th></th>\");\n        fundTypeHtml.push(\" </thead>\");\n        fundTypeHtml.push(  fundsHtml.join(\" \"));\n        fundTypeHtml.push(\"</table>\");\n      });\n\n      $(\"#result-block\").removeClass();\n      if(fundTypeHtml && fundTypeHtml.length > 0){\n        $(\"#result-block\").addClass('has-data').html(fundTypeHtml.join(\" \"));\n      }else{\n        $(\"#result-block\").addClass('empty-data').html(\"<div class='no-result'>無查詢結果</div>\");\n      }\n\n      deferred.resolve();\n  });\n\n  return deferred.promise();    \n\n}\n\n$(document).on( \"pageinit\", \"#page-fund-nv\", function(event) {\n\n  //使用Derffered Ojbect讓資料載入後，再解除Loading\n  var dLoadCompany = $.Deferred(),\n      dLoadType = $.Deferred();\n\n  App.StartLoading();    \n\n  $(\".numura-warning\").loadWarning();\n\n  $(\"#input-keyword\").val(sessionStorage.getItem(\"fundKeyword\"));\n\n  $(\"#select-company\").loadSelectFundCompany(\n      {\n        \"success\":function(){\n          dLoadCompany.resolve();\n        },\"failure\":function(){\n          dLoadCompany.reject();\n        }\n      }\n  );\n\n  $(\"#select-type\").loadSelectFundType(\n      {\n        \"success\":function(){\n          dLoadType.resolve();\n        },\"failure\":function(){\n          dLoadType.reject();\n        }\n      }    \n  );\n\n  $.when(dLoadCompany,dLoadType)\n    .then(function(){\n      if(sessionStorage.getItem(\"fundCompany\")){\n        $(\"#select-company\")\n          .val(sessionStorage.getItem(\"fundCompany\"))\n          .selectmenu(\"refresh\",true);\n      }\n      if(sessionStorage.getItem(\"fundType\")){\n        $(\"#select-type\")\n          .val(sessionStorage.getItem(\"fundType\"))\n          .selectmenu(\"refresh\",true);\n      }\n      //ajaxLoadFundNetWorth();      \n      $.when(ajaxLoadFundNetWorth()).done(function(){\n        App.StopLoading();\n      });\n    }).done(function(){\n      //App.StopLoading();\n  });\n  \n\n});\n\n$(document).on(\"vclick\",\".fund-item\",function(event){\n    sessionStorage.setItem(\"fundid\",$(this).data(\"fundid\"));\n    location.href = \"../html/singleFundInfo.html\";\n});\n\n$(document).on(\"vclick\",\"#btn-submit\",function(event){\n  var pattern = /^[A-z0-9 \\u4e00-\\u9fa5]+$/;\n  var keyword = $(\"#input-keyword\").val();\n  if(keyword.length > 0 && !pattern.test(keyword)){\n    App.ShowAlert('請勿輸入符號或全形英數',\"\",\"確定\");\n    return false;\n  }\n\n  sessionStorage.setItem(\"fundCompany\",$(\"#select-company\").val());\n  sessionStorage.setItem(\"fundType\",$(\"#select-type\").val());\n  sessionStorage.setItem(\"fundKeyword\",keyword);\n\n  App.StartLoading();\n\n  $.when(ajaxLoadFundNetWorth()).done(function(){\n    App.StopLoading();\n  });\n  \n});"],"sourceRoot":"/source/"}