{"version":3,"sources":["fundNetWorth/singleFundInfo.js"],"names":["ajaxLoadFundFile","deferred","$","Deferred","ajax","url","Constants","getFundFileUrl","type","done","xml","$fundInfo","find","sessionStorage","getItem","item","dataFile","attr","data","resolve","promise","ajaxLoadSingleFundInfo","postdata","fundId","filterXSS","getSingleFundInfoUrl","response","FundInfo","fundHtml","setItem","FundCode","CoalitionFundCode","FundShortName","JSON","stringify","MoneyDividendTypes","html","loadMoneyType","css","padding-top","outerHeight","loadSelectMoneyDividendTypes","moneyDividendTypes","selectedValue","FundId","each","getFundInfoTable","index","cellContent","Key","cellDateContent","regExp","matches","hasSubStringWithDate","Type","Date","format","exec","replace","DateKey","push","Caption","join","listFavoriteCallback","_favlist","favlist","fundcode","isFav","_","includes","toggleClass","document","on","event","buttonBlockTop","offset","top","headerHeight","scrollTo","mobile","silentScroll","App","StartLoading","this","val","then","StopLoading","filepath","isEmpty","ShowAlert","OpenFile","filePrefixUrl","location","href","is","removeClass","RemoveFavorite","addClass","AddFavorite","loadWarning","isSales","setTimeout","ListFavorite"],"mappings":"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","file":"fundNetWorth/singleFundInfo.min.js","sourcesContent":["function ajaxLoadFundFile(){\n\tvar deferred = $.Deferred();\n\t$.ajax({\n\t\turl: Constants.getFundFileUrl(),\n      \ttype:\"GET\"\n  \t}).done(function(xml){\n      var $fundInfo = $(xml).find(\"[FundConCode='\" + sessionStorage.getItem(\"coalitionFundCode\") + \"']\");\n      var item = $fundInfo.find(\"[EnName='C']\");\n      var dataFile = item.attr(\"ChName\");\n      $(\"#btn-fundMonth\").data(\"file\",dataFile);\n      deferred.resolve();\n\t});\n\treturn deferred.promise();\n}\n\nfunction ajaxLoadSingleFundInfo(){\n\tvar deferred = $.Deferred();\n  \tvar postdata = {};\n  \tpostdata.fundId = filterXSS(sessionStorage.getItem(\"fundid\"));\n\t$.ajax({\n\t\turl: Constants.getSingleFundInfoUrl(),\n      \ttype:\"GET\",\n      \tdata:postdata\n  \t}).done(function(response){\n  \t\tvar FundInfo = response;\n\t\tvar fundHtml = [];\n\n\t\tsessionStorage.setItem(\"fundCode\",FundInfo.FundCode);\n  \t\tsessionStorage.setItem(\"coalitionFundCode\",FundInfo.CoalitionFundCode);\n  \t\tsessionStorage.setItem(\"FundShortName\",FundInfo.FundShortName);\n  \t\tsessionStorage.setItem(\"MoneyDividendTypes\",JSON.stringify(FundInfo.MoneyDividendTypes)); \n\n\t\t$(\"#shortname\").html(FundInfo.FundShortName);\n  \t\t$(\"[data-role='moneytype']\").loadMoneyType(FundInfo.MoneyDividendTypes);\n\n\t\t$(\"[data-role='page']\").css({\n\t\t\t\"padding-top\":$(\"[data-role='header']\").outerHeight(true) + \"px\"\n\t\t});\n\n  \t\t$(\"#select-fund\").loadSelectMoneyDividendTypes({\n  \t\t\t'moneyDividendTypes':FundInfo.MoneyDividendTypes,\n  \t\t\t'selectedValue':FundInfo.FundId\n  \t\t});\n\t\t$.each(Constants.getFundInfoTable(), function(index, item) {\n\t\t\tvar cellContent = FundInfo[item.Key],\n\t\t\t\tcellDateContent = \"\";\n\n\t\t\tvar regExp = /\\(([^)]+)\\)/,\n\t\t\t\tmatches = [],\n\t\t\t\thasSubStringWithDate = false;\n\n\t\t\tif(item.Type && item.Type === 'Date'){\n\t\t\t\tcellContent= (cellContent) ? (new Date(cellContent)).format(\"yyyy/mm/dd\") : \"N/A\";\n\t\t\t}\n\n\t\t\tif(item.Key === \"FundScale\" && cellContent){\n\t\t\t\t//Regular Expression to get a string between parentheses in Javascript\n\t\t\t\tmatches = regExp.exec(cellContent);\n\t\t\t\tcellContent = cellContent.replace(matches[0],\"\");\n\t\t\t\tcellDateContent = matches[1];\n\t\t\t\thasSubStringWithDate = true;\n\t\t\t}\n\n\t\t\tif(item.DateKey || hasSubStringWithDate){\n\t\t\t\tif(item.DateKey){\n\t\t\t\t\tcellDateContent = (FundInfo[item.DateKey]) ? (new Date(FundInfo[item.DateKey])).format(\"yyyy/mm/dd\") : \"N/A\";\n\t\t\t\t}\n\t\t\t\tcellDateContent = \n\t\t\t\t\t\"<span class='cell-date'>(\" + \n\t\t\t\t\tcellDateContent + \n\t\t\t\t\t\")</span>\";\n\t\t\t}\n\n\t\t\tcellContent = (cellContent) ? cellContent : \"N/A\";\n\n\t\t\tfundHtml.push(\"<tbody>\");\n\t\t\tfundHtml.push(\"<tr>\");\n\t\t\tfundHtml.push(\t\"<td class='cell-caption'>\" + item.Caption + \"</td>\");\n\t\t\tfundHtml.push(\t\"<td class='cell-content'>\");\n\t\t\tfundHtml.push(\tcellContent + \" \" + cellDateContent);\n\t\t\tfundHtml.push(\t\"</td>\");\n\t\t\tfundHtml.push(\"</tr>\");\n\t\t\tfundHtml.push(\"</tbody>\");\t\t\t\n\t\t});\n\t\t$(\"[data-role='table']\").html(fundHtml.join(\" \"));\n\t\tdeferred.resolve();\n\t});\n\treturn deferred.promise();\t\n}\n\nfunction listFavoriteCallback(_favlist){\n\tvar favlist = _favlist || [];\n\tvar fundcode = sessionStorage.getItem(\"fundCode\");\n\tvar isFav = _.includes(favlist,fundcode);\n\t$(\"#fav-button\").toggleClass(\"icon-isfav\",isFav);\n}\n\n$(document).on(\"vclick\",\"#goto-button-block\",function(event){\n\tvar buttonBlockTop = $(\"#button-block\").offset().top,\n\t\theaderHeight = $(\"[data-role='header']\").outerHeight(true),\n\t\tscrollTo = buttonBlockTop - headerHeight;\n\t$.mobile.silentScroll(scrollTo);\n});\n\n$(document).on(\"change\",\"#select-fund\",function(event){\n\tApp.StartLoading();\n\tsessionStorage.setItem(\"fundid\",$(this).val()); \n  \tajaxLoadSingleFundInfo().then(function(){\n  \t\tajaxLoadFundFile();\n  \t}).done(function(){\n    \tApp.StopLoading();\n    });\n});\n\n$(document).on(\"vclick\",\"#btn-fundMonth\",function(event){\n  var filepath = $(this).data(\"file\");\n  if(_.isEmpty(filepath)){\n    App.ShowAlert('很抱歉，檔案尚待更新',\"\",'確定');\n  }else{\n    App.OpenFile(Constants.filePrefixUrl + filepath);\n  }\n  return false;\n});\n\n$(document).on(\"vclick\",\"#btn-fnr\",function(event){\n\tlocation.href = \"../html/fundFeatureAndRisk.html\";\n});\n\n$(document).on(\"vclick\",\"#btn-report\",function(event){\n\tlocation.href = \"../html/singleFundReport.html\";\n});\n\n$(document).on(\"vclick\",\"#btn-holding\",function(event){\n\tlocation.href = \"../html/singleFundHolding.html\";\n});\n\n$(document).on(\"vclick\",\"#btn-sfnw\",function(event){\n\tlocation.href = \"../html/singleFundNetWorth.html\";\n});\n\n$(document).on(\"vclick\",\"#btn-sfa\",function(event){\n\tlocation.href = \"../html/singleFundAchievement.html\";\n});\n\n$(document).on(\"vclick\",\"#btn-sff\",function(event){\n\tlocation.href = \"../html/singleFundFile.html\";\n});\n\n$(document).on(\"vclick\",\"#fav-button\",function(event){\n\tvar fundcode = sessionStorage.getItem(\"fundCode\");\n\tvar isFav = $(this).is(\".icon-isfav\");\n\tif(isFav){\n\t\t$(this).removeClass(\"icon-isfav\");\n\t\tApp.RemoveFavorite(fundcode);\n\t}else{\n\t\t$(this).addClass(\"icon-isfav\");\n\t\tApp.AddFavorite(fundcode);\n\t}\t\n});\n\n$(document).on( \"pageinit\", \"#page-sfund-info\", function(event) {\n\tApp.StartLoading();\n  \t$(\".numura-warning\").loadWarning();\n  \tajaxLoadSingleFundInfo().then(function(){\n  \t\tajaxLoadFundFile();\n  \t}).done(function(){\n  \t\t$(\"#button-block\").toggleClass(\"show\");\n    \tApp.StopLoading();\n\t\tif($.isSales()){\n\t\t\t$(\"#fav-button\").removeClass(\"hide\").addClass(\"inline-block\");\n\t\t\tsetTimeout(App.ListFavorite(),3000);\n\t\t}\n    });\n});"],"sourceRoot":"/source/"}