{"version":3,"sources":["plugin/jquery.nomura.js"],"names":["$","getParameterByName","name","url","window","location","href","replace","regex","RegExp","results","exec","decodeURIComponent","getAppName","appname","sessionStorage","getItem","setItem","filterXSS","isSales","isRetail","cxRise","value","parseFloat","getDefaultInterval","result","_","find","Constants","getFundIntervalOptions","item","Default","fn","loadMaxAndMinValueTable","options","tableHtml","settings","extend","tableCaption","maxValue","maxValueDate","minValue","minValueDate","callback","this","each","$this","push","html","join","loadFundIntervals","optionHtml","optionCaption","optionDivider","index","selected","Value","Text","selectmenu","loadMoneyType","moneyTypes","moneyTypeHtml","uniqMoneyTypes","map","uniq","EnglishName","MoneyTypeName","cxBgcolor","toLowerCase","loadSelectMoneyDividendTypes","moneyDividendTypes","selectedValue","FundId","FundShortName","length","val","parseInt","closest","hide","loadSelectFundCompany","isretail","excludeValueList","success","failure","getFundCompanyRetailUrl","getFundCompanyUrl","ajax","type","done","response","fundCompanyList","filter","includes","CompanyId","CompanyShort","call","fail","loadSelectFundType","includeFundTypeAll","getFundTypeUrl","fundTypeList","TypeId","TypeName","loadWarning","output","warning","getWarning","origin","phone","phonetext","website","headline","article","outputHtml","highlight","highlightlg","jQuery"],"mappings":"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","file":"plugin/jquery.nomura.min.js","sourcesContent":["/* 此為共用Function，使用jQuery Plugin的方式\n * 使用前需先載入下列JS Library\n * ● jQuery (因為不需支援IE，所以使用2.0以上版本)\n * ● jQuery Mobile (使用jQM1.4以上版本)\n * ● lodash (因為使用lodash的集合操作util method)\n * ● constants.js (用以取得集中設定的API網址)\n */\n(function($){\n\n  $.getParameterByName = function(name, url){\n    if (!url) url = window.location.href;\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n  };\n\n  $.getAppName = function(){\n    var appname = \"\";\n    if(sessionStorage.getItem(\"appname\")){\n      appname = sessionStorage.getItem(\"appname\");\n    }else{\n      appname = $.getParameterByName(\"appname\",window.location.href);\n      sessionStorage.setItem(\"appname\",filterXSS(appname));\n    }\n    return appname;    \n  };\n\n  $.isSales = function(){\n    return ($.getAppName() === \"sales\") ? true :false;\n  };\n\n  $.isRetail = function(){\n    return ($.getAppName() === \"retail\") ? true :false;\n  };\n\n  //傳入值去判斷class的值\n  $.cxRise = function(value){\n    return (parseFloat(value) > 0) ? \"rise\" : \"\";\n  };\n\n  //取得FundInterval設為Default的值\n  $.getDefaultInterval = function(){\n    var result = \n      _.result(\n        _.find(Constants.getFundIntervalOptions(), function(item) {\n          return item.Default;\n        }),'Value');\n    return result;\n  };\n\n  //產出最高與最低值的表格型態\n  $.fn.loadMaxAndMinValueTable = function(options){\n    var tableHtml = [];\n\n    var settings = $.extend({\n      'tableCaption' : '',\n      'maxValue' : '',\n      'maxValueDate' : '',\n      'minValue' : '',\n      'minValueDate' : '',\n      'callback':function(){}\n    },options);\n\n    return this.each(function() {\n      var $this = $(this);\n      tableHtml.push(\" <thead>\");\n      tableHtml.push(\"   <th>\" + settings.tableCaption + \"</th><th>最高</th><th>最低</th>\");\n      tableHtml.push(\" </thead>\");\n      tableHtml.push(\" <tbody>\");\n      tableHtml.push(\"   <td></td>\");\n      tableHtml.push(\"   <td>\");\n      tableHtml.push(\"    <div class='net-worth'>\" + settings.maxValue + \"</div>\");\n      tableHtml.push(\"    <div class='net-worth-date'>(\" + settings.maxValueDate + \")</div>\");\n      tableHtml.push(\"   </td>\");\n      tableHtml.push(\"   <td>\");\n      tableHtml.push(\"    <div class='net-worth'>\" + settings.minValue + \"</div>\");\n      tableHtml.push(\"    <div class='net-worth-date'>(\" + settings.minValueDate + \")</div>\");\n      tableHtml.push(\"   </td>\");      \n      tableHtml.push(\" </tbody>\");      \n      $this.html(tableHtml.join(\" \"));\n    });\n  };  \n\n  //產出FundInterval的下拉式選單\n  $.fn.loadFundIntervals = function(options){\n    var optionHtml = [];\n\n    var settings = $.extend({\n      'optionCaption' : '',\n      'optionDivider' : '',\n      'callback':function(){}\n    },options);\n\n    return this.each(function() {\n      var $this = $(this);\n      $.each(Constants.getFundIntervalOptions(),function(index,item){\n        var selected = (item.Default) ? \" selected \" : \"\";\n        optionHtml.push(\"<option value=\" + item.Value + selected + \">\");\n        optionHtml.push(settings.optionCaption + settings.optionDivider + item.Text);\n        optionHtml.push(\"</option>\");\n      });\n\n      $this\n        .html(optionHtml.join(\" \"))\n        .selectmenu(\"refresh\",true);\n    });\n  };\n\n  //產出幣別的方塊\n  $.fn.loadMoneyType = function(moneyTypes){\n      \n    var moneyTypeHtml = [];\n\n    var uniqMoneyTypes = \n      _.map(\n        _.uniq(moneyTypes,'EnglishName'),\n        function(item){\n          return {\n            'EnglishName':item.EnglishName,\n            'MoneyTypeName':item.MoneyTypeName\n          };\n      });\n\n    $.each(uniqMoneyTypes, function(index, item) {\n      var cxBgcolor = \"bgcolor-\" + item.EnglishName.toLowerCase();\n      moneyTypeHtml.push(\"<div class='item \" + cxBgcolor + \"'>\");\n      moneyTypeHtml.push(item.MoneyTypeName);\n      moneyTypeHtml.push(\"</div>\");\n    });\n\n    return this.each(function() {\n      var $this = $(this);\n      $this.html(moneyTypeHtml.join(\" \"));\n    });      \n\n  };\n\n  //require jqm plugin first\n  //產出MoneyDividendTypes的選單\n  $.fn.loadSelectMoneyDividendTypes = function(options) {\n\n    var optionHtml = [];\n\n    var settings = $.extend({\n      'moneyDividendTypes' : [],\n      'selectedValue':null,\n      'callback':function(){}\n    },options);\n\n    return this.each(function() {\n      var $this = $(this);\n      $.each(settings.moneyDividendTypes,function(index,item){\n        optionHtml.push(\"<option value=\" + item.FundId + \">\");\n        optionHtml.push(item.FundShortName);\n        optionHtml.push(\"</option>\");\n      });\n\n      if(settings.moneyDividendTypes.length > 1){\n        $this.html(optionHtml.join(\" \"));          \n        if(settings.selectedValue){\n          $this.val(parseInt(settings.selectedValue));\n        }\n        $this.selectmenu(\"refresh\",true);\n      }else{\n        $this.closest(\"[data-role='headline']\").hide();\n      }\n    });\n  };  \n\n  //require jqm plugin first\n  //產出基金公司的選單\n  $.fn.loadSelectFundCompany = function(options) {\n\n    var settings = $.extend({\n      'isretail':false,\n      'excludeValueList' : [],\n      'success':function(){},\n      'failure':function(){}\n    },options);\n\n    return this.each(function() {\n      var $this = $(this);\n      var url = (settings.isretail) ? Constants.getFundCompanyRetailUrl() : Constants.getFundCompanyUrl();\n      $.ajax({\n        url: url,\n        type:\"GET\"\n      }).done(function(response){\n        var optionHtml = [];\n        var fundCompanyList = _.filter(response,function(item){\n          return !(_.includes(settings.excludeValueList,item.CompanyId+\"\"));\n        });\n        $.each(fundCompanyList, function(index,item) {\n            optionHtml.push('<option value=\"'+ item.CompanyId +'\">'+ item.CompanyShort +'</option>');\n        });\n        $this.html(optionHtml.join(\" \")).selectmenu(\"refresh\",true);\n        settings.success.call($this);\n      }).fail(function(){\n        settings.failure.call($this);\n      });\n    });\n  };\n\n  //require jqm plugin first\n  //產出基金型態的選單\n  $.fn.loadSelectFundType = function(options) {\n\n    var settings = $.extend({\n      includeFundTypeAll:true,\n      'success':function(){},\n      'failure':function(){}     \n    },options);\n\n    return this.each(function(options) {\n      var $this = $(this);\n      $.ajax({\n        url: Constants.getFundTypeUrl(),\n        type:\"GET\"\n      }).done(function(response){\n        var fundTypeList = response,\n            optionHtml = [];\n        if(settings.includeFundTypeAll){\n          optionHtml.push('<option value=\"\">所有基金類型</option>');\n        }\n        $.each(fundTypeList, function(index,item) {\n          optionHtml.push('<option value=\"'+ item.TypeId +'\">'+ item.TypeName +'</option>');\n        });\n        $this.html(optionHtml.join(\" \")).selectmenu(\"refresh\",true);\n        settings.success.call($this);\n      }).fail(function(){\n        settings.failure.call($this);\n      });      \n    });\n  };\n  \n  //載入警語 \n  $.fn.loadWarning = function() {\n\n    var output = [],\n        warning = Constants.getWarning();\n\n    if($.isRetail()){\n      output.push(\"<div class='contact-info'>\");\n      output.push(\" <div class='origin-source'>\" + warning.origin + \"</div>\");\n      output.push(\" <div><a href='\" + warning.phone + \"'>\" + warning.phonetext + \"</a></div>\");\n      output.push(\" <div><a href='http://\" + warning.website + \"'>\" + warning.website + \"</a></div>\");\n      output.push(\"</div>\");\n    }\n\n    output.push(\"<div class='warning-info'>\");\n    output.push(\" <div>\" + warning.headline + \"</div>\");\n    output.push(\" <div>\" + warning.article + \"</div>\");\n    output.push(\"</div>\");    \n    return $(this).each(function() {\n      var outputHtml = output.join(\" \");\n      $.each(warning.highlight, function(index, item) {\n        outputHtml = outputHtml.replace(item,\"<span class='highlight'>\" + item + \"</span>\");\n      });\n      $.each(warning.highlightlg, function(index, item) {\n        outputHtml = outputHtml.replace(item,\"<span class='highlightlg'>\" + item + \"</span>\");\n      });\n      $(this).html(outputHtml);\n    });\n  };\n\n}(jQuery));"],"sourceRoot":"/source/"}